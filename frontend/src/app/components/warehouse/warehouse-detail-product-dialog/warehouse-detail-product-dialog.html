<div class="dialog">
    <div class="dialog__header">
        <div class="dialog__title-wrap">
            <h2 class="dialog__title">Stock Details</h2>
            <p class="dialog__subtitle">
                {{ stock.product_sku }} — {{ stock.product_name }}
            </p>
        </div>
    </div>

    <div class="section">
        <div class="section__title">Warehouse</div>
        <div class="kv">
            <div class="kv__row">
                <span>Updated</span><b>{{ stock.updated_at | date:'medium' }}</b>
            </div>
        </div>
    </div>

    <div class="section">
        <div class="section__title">Product</div>
        <div class="kv">
            <div class="kv__row"><span>SKU</span><b>{{ stock.product_sku }}</b></div>
            <div class="kv__row"><span>Name</span><b>{{ stock.product_name }}</b></div>
            <div class="kv__row"><span>Unit</span><b>{{ stock.product_unit }}</b></div>
            <div class="kv__row"><span>Sell price</span><b>{{ stock.price_sell | number:'1.2-2' }} лв</b></div>
            <div class="kv__row"><span>Buy price</span><b>{{ stock.price_buy | number:'1.2-2' }} лв</b></div>
        </div>
    </div>

    <div class="section">
        <div class="section__title">
            Stock
            <span style="flex: 1"></span>


        </div>

        <!-- VIEW MODE -->
        @if (!isEditing) {
            <div class="kv">
                <div class="kv__row"><span>Quantity</span><b>{{ stock.quantity }}</b></div>
                <div class="kv__row"><span>Min stock level</span><b>{{ stock.min_stock_level }}</b></div>
            </div>
        }

        <!-- EDIT MODE -->
        @if (isEditing) {
            @if (errorMessage) {
                <div class="form-error">{{ errorMessage }}</div>
            }

            <form [formGroup]="form" (ngSubmit)="onSave()" class="form">
                <div class="field">
                    <label>Quantity</label>
                    <input type="number" step="0.01" formControlName="quantity" />
                </div>

                <div class="field">
                    <label>Min Stock Level</label>
                    <input type="number" step="0.01" formControlName="min_stock_level" />
                </div>

                <div class="actions">
                    <button type="button" class="btn ghost" (click)="cancelEdit()" [disabled]="isSaving">
                        Cancel
                    </button>

                    <button type="submit" class="btn primary" [disabled]="form.invalid || isSaving">
                        {{ isSaving ? 'Saving...' : 'Save' }}
                    </button>
                </div>
            </form>
        }
    </div>

    <!-- Footer actions -->
    <div class="actions">
        @if (!isEditing) {
            <button type="button" class="btn ghost" (click)="enterEdit()">Edit</button>
        }
        <button type="button" class="btn ghost" (click)="onClose()">Close</button>

    </div>

</div>
